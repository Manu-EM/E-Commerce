{% extends 'base.html' %}
{% load static %}
{% block title %}{{ product.name }} | Ecommerce{% endblock %}

{% block content %}
<div class="container my-5">
  <div class="row">
    
    <!-- Product Images -->
    <div class="col-md-6 text-center">
      {% if product.images.first %}
        <img id="mainImage" 
             src="{{ product.images.first.image.url }}" 
             class="img-fluid border mb-3 rounded shadow-sm" 
             style="max-height:400px; object-fit:contain;">
      {% else %}
        <img id="mainImage" 
             src="{% static 'images/no-image.png' %}" 
             class="img-fluid border mb-3 rounded shadow-sm" 
             style="max-height:400px; object-fit:contain;">
      {% endif %}

      <!-- Thumbnails -->
      {% if product.images.all %}
      <div class="d-flex flex-wrap gap-2 justify-content-center mt-2">
        {% for img in product.images.all %}
          <img src="{{ img.image.url }}" 
               class="border rounded thumb-img shadow-sm" 
               width="70" height="70" 
               style="object-fit:cover; cursor:pointer;"
               onclick="document.getElementById('mainImage').src=this.src;">
        {% endfor %}
      </div>
      {% endif %}
    </div>

    <!-- Product Details -->
    <div class="col-md-6">
      <h2 class="fw-bold">{{ product.name }}</h2>
      <h4 class="text-success">â‚¹{{ product.price }}</h4>
      <p class="mt-3">{{ product.description }}</p>

      <!-- Stock -->
      <p><strong>Stock:</strong> 
        {% if product.stock > 0 %}
          <span class="text-success">{{ product.stock }} available</span>
        {% else %}
          <span class="text-danger">Out of stock</span>
        {% endif %}
      </p>

      <!-- Add to Cart -->
      {% if product.stock > 0 %}
        <form method="post" action="{% url 'add_to_cart' product.id %}">
          {% csrf_token %}
          <div class="d-flex align-items-center gap-2">
            <input type="number" name="quantity" value="1" min="1" 
                   max="{{ product.stock }}" 
                   class="form-control w-25">
            <button type="submit" class="btn btn-success">
              <i class="bi bi-cart-plus"></i> Add to Cart
            </button>
          </div>
        </form>
      {% else %}
        <button class="btn btn-secondary" disabled>
          <i class="bi bi-x-circle"></i> Out of Stock
        </button>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
